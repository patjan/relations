User=Ember.Object.extend({first_name:"",last_name:"",user_role:"",start_page:"",session_id:""}),window.CX=Ember.Application.create(),CX.AJAX_URL="http://dev-unittest.inhouseusa.com/middleware/json/",CX.main=Em.View.create({templateName:"main"}),CX.NavState=Em.LayoutState.extend({navSelector:".navbar .nav",enter:function(e,t){this._super(e,t);var n=$(this.get("navSelector"));n.children().removeClass("active");var r=this.get("selector")||"."+this.get("path");n.find(r).addClass("active")}}),CX.routeManager=Em.RouteManager.create({rootView:CX.main,login:CX.NavState.create({selector:".login",route:"login",viewClass:Em.View.extend({templateName:"login"})}),logout:CX.NavState.create({selector:".logout",route:"login",viewClass:Em.View.extend({templateName:"login"})}),dashboard:CX.NavState.create({selector:".dashboard",route:"dashboard",viewClass:Em.View.extend({templateName:"dashboard"})})}),CX.index_start=function(){Em.TEMPLATES.main?(CX.main.appendTo("body"),CX.routeManager.start(),CX.login_start()):setTimeout(function(){CX.index_start()},100)},CX.login_start=function(){Em.TEMPLATES.login?(CX.routeManager.set("location","login"),CX.login_setup()):setTimeout(function(){CX.login_start()},100)},CX.login_setup=function(){$("#user-name")?($(".login-form").validate({success:function(e){e.text("OK!").addClass("valid").closest(".control-group").addClass("success")},submitHandler:function(e){return!1}}),$("#user-name").focus()):setTimeout(function(){CX.login_setup()},100)},CX.login_submit=function(){$("#user-name").focus(),reset_message("log-in");var e="msi",t=$("#user-name").val(),n=$("#password").val();if(t==""||n=="")return set_message("log-in","Missing required field(s)."),!1;var r={client_id:e,user_name:t,password:$.md5(n)};$.ajax({url:CX.AJAX_URL+"users/login",async:!1,dataType:"json",data:r,error:function(e,t,n){set_message("log-in","Error from backend server, please re-try later.")},success:function(e){var t=e.status,n=e.message,r=e.data;t!="ok"?set_message("log-in","User Name or Password are invalid."):(user=User.create(),user.set("first_name",r.first_name),user.set("last_name",r.last_name),user.set("user_role",r.user_role),user.set("start_page",r.start_page),$("#header-info").html("<span id='user-info'>Welcome "+user.get("first_name")+"</span>"),$(".dashboard 	a").removeAttr("class").attr("href","#").attr("onclick","CX.dashboard_start()"),$(".view-orders	a").removeAttr("class").attr("href","#view-orders"),$(".admin 		a").removeAttr("class").attr("href","#admin"),$(".my-profile 	a").removeAttr("class").attr("href","#my-profile"),$(".search 		a").removeAttr("class").attr("href","#search"),$(".logout 		a").removeAttr("class").attr("href","#").attr("onclick","CX.logout_start()"),r["start_page"]=="dashboard"&&CX.dashboard_start())}})},CX.is_session_gone=function(){var e;return $.ajax({url:CX.AJAX_URL+"users/check_session",async:!1,error:function(e,t,n){alert("error, message: "+n)},success:function(t){var n=t.status;n!="ok"?e=!0:e=!1}}),e},CX.logout_start=function(){$.ajax({url:CX.AJAX_URL+"users/logout",async:!1,error:function(e,t,n){alert("error, message: "+n)},success:function(e){user=User.create(),user.set("first_name",""),user.set("last_name",""),user.set("user_role",""),user.set("start_page",""),$("#header-info").html(""),$(".view-orders	a").removeAttr("href").attr("class","disabled"),$(".admin 		a").removeAttr("href").attr("class","disabled"),$(".my-profile 	a").removeAttr("href").attr("class","disabled"),$(".search 		a").removeAttr("href").attr("class","disabled"),$(".logout 		a").removeAttr("href").removeAttr("onclick").attr("class","disabled"),CX.login_start()}})},CX.dashboard_start=function(){if(CX.is_session_gone()){CX.login_start();return}CX.dashboard_setup()},CX.dashboard_setup=function(){Em.TEMPLATES.dashboard?(CX.routeManager.set("location","dashboard"),CX.dashboard_get_data()):setTimeout(function(){CX.dashboard_setup()},100)},CX.dashboard_get_data=function(){$.ajax({url:CX.AJAX_URL+"dashboard",async:!0,error:function(e,t,n){alert("error, message: "+n)},success:function(e){var t=e.status,n=e.message,r=e.data;t!="ok"?alert("error, message: "+n):(CX.display_open_pipeline(r.module_open_pipelines),CX.display_recent_activities(r.module_recent_activity),CX.display_recent_notes(r.module_recent_notes),CX.display_due_today(r.module_due_today))}})},CX.display_open_pipeline=function(e){var t=e.total,e=e.data,n=[];n.push(e.Partial),n.push(e["Request Entered"]),n.push(e["Request Approved"]),n.push(e["Vendor Accepted"]),n.push(e.Inspected),n.push(e["Conditioned Order"]),n.push(e["Order Assigned"]),n.push(e.Scheduled),n.push(e["On Hold"]);var r=["<br>Partial","Request<br>Entered","Request<br>Approved","Vendor<br>Accepted","<br>Inspected","Conditioned<br>Order","Order<br>Assigned","Scheduled","<br>On Hold"];$.jqplot.config.enablePlugins=!0,$.jqplot("open-pipeline",[n],{animate:!$.jqplot.use_excanvas,seriesDefaults:{renderer:$.jqplot.BarRenderer,pointLabels:{show:!0}},axes:{xaxis:{renderer:$.jqplot.CategoryAxisRenderer,ticks:r}},highlighter:{show:!1}})},CX.display_recent_activities=function(e){var e=e.data,t="",n;t+="<tr><th width=10%>ID#</th><th width=20%>Borrower</th><th width=35%>Status</th><th width=35%>Status Date</th></tr>";for(var r=0;r<e.length;r++)n=e[r],t+="<tr ><td class='center'>"+n.ID+"</td>"+"<td>"+n.Borrower+"</td>"+"<td>"+n.Status+"</td>"+"<td>"+n["Note Date"]+"</td>"+"</tr>";$("#recent-activities").html(t)},CX.display_recent_notes=function(e){var e=e.data,t="",n;t+="<tr><th width=10%>ID#</th><th width=20%>Loan#</th><th width=35%>Note</th><th width=35%>Note Date</th></tr>";for(var r=0;r<e.length;r++)n=e[r],t+="<tr><td class='center'>"+n.ID+"</td>"+"<td>"+n["Loan Number"]+"</td>"+"<td>"+n.Note+"</td>"+"<td>"+n["Note Date"]+"</td>"+"</tr>";$("#recent-notes").html(t)},CX.display_due_today=function(e){var e=e.data,t="",n;t+="<tr><th width=10%>ID#</th><th width=15%>Vendor</th><th width=15%>Loan#</th><th width=25%>Borrower</th><th width=35%>Taget Date</th></tr>";for(var r=0;r<e.length;r++)n=e[r],t+="<tr><td class='center'>"+n.ID+"</td>"+"<td>"+n.Vendor+"</td>"+"<td>"+n["Loan Number"]+"</td>"+"<td>"+n.Borrower+"</td>"+"<td>"+n["Target Date"]+"</td>"+"</tr>";$("#due-today").html(t)};